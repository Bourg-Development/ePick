<div class="header">
    <h1><%= __('profile.integrations.title') %></h1>
    <p><%= __('profile.integrations.description') %></p>
</div>

<div class="settings-container">
    <!-- Calendar Integration -->
    <div class="settings-card">
        <div class="card-header">
            <h2>
                <span class="material-symbols-outlined">calendar_month</span>
                <%= __('profile.integrations.calendarIntegration') %>
            </h2>
            <p><%= __('profile.integrations.calendarIntegrationDesc') %></p>
        </div>
        <div class="card-content">
            <div class="ics-feed-section">
                <div class="ics-feed-info">
                    <div class="ics-feed-status" id="icsFeedStatus">
                        <span class="material-symbols-outlined">sync</span>
                        <span class="status-text">Loading...</span>
                    </div>
                </div>
                <div class="ics-feed-controls">
                    <div class="ics-feed-toggle">
                        <label class="switch">
                            <input type="checkbox" id="icsFeedToggle" disabled>
                            <span class="slider"></span>
                        </label>
                        <span class="toggle-label"><%= __('profile.integrations.enableIcsFeed') %></span>
                    </div>
                    <div class="ics-feed-url-container" id="icsFeedUrlContainer" style="display: none;">
                        <label><%= __('profile.integrations.feedUrl') %></label>
                        <div class="url-input-group">
                            <input type="text" id="icsFeedUrl" readonly class="form-control">
                            <button class="btn btn-primary" id="copyIcsFeedBtn">
                                <span class="material-symbols-outlined">content_copy</span>
                                <%= __('profile.integrations.copy') %>
                            </button>
                            <button class="btn btn-secondary" id="subscribeIcsFeedBtn">
                                <span class="material-symbols-outlined">calendar_add_on</span>
                                <%= __('profile.integrations.subscribe') %>
                            </button>
                        </div>
                        <small class="help-text"><%= __('profile.integrations.copyManualHelp') %></small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Notifications -->
    <div class="settings-card">
        <div class="card-header">
            <h2>
                <span class="material-symbols-outlined">email</span>
                <%= __('profile.integrations.emailNotifications') %>
            </h2>
            <p><%= __('profile.integrations.emailNotificationsDesc') %></p>
        </div>
        <div class="card-content">
            <div class="notification-availability" id="emailAvailabilityStatus">
                <!-- This will be populated by JavaScript -->
            </div>

            <div class="notification-categories" id="emailNotificationCategories" style="display: none;">
                <div class="notification-category">
                    <div class="category-header">
                        <h3><%= __('profile.integrations.securityNotifications') %></h3>
                        <p><%= __('profile.integrations.securityNotificationsDesc') %></p>
                    </div>
                    <div class="notification-options">
                        <div class="notification-option">
                            <div class="option-info">
                                <h4><%= __('profile.integrations.loginAlerts') %></h4>
                                <p><%= __('profile.integrations.loginAlertsDesc') %></p>
                            </div>
                            <div class="option-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailLoginAlerts">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="notification-option">
                            <div class="option-info">
                                <h4><%= __('profile.integrations.passwordChanges') %></h4>
                                <p><%= __('profile.integrations.passwordChangesDesc') %></p>
                            </div>
                            <div class="option-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailPasswordChanges">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="notification-option">
                            <div class="option-info">
                                <h4><%= __('profile.integrations.securitySettingsChanges') %></h4>
                                <p><%= __('profile.integrations.securitySettingsChangesDesc') %></p>
                            </div>
                            <div class="option-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailSecurityChanges">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="notification-category">
                    <div class="category-header">
                        <h3><%= __('profile.integrations.systemNotifications') %></h3>
                        <p><%= __('profile.integrations.systemNotificationsDesc') %></p>
                    </div>
                    <div class="notification-options">
                        <div class="notification-option">
                            <div class="option-info">
                                <h4><%= __('profile.integrations.systemMaintenance') %></h4>
                                <p><%= __('profile.integrations.systemMaintenanceDesc') %></p>
                            </div>
                            <div class="option-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailSystemMaintenance">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="notification-option">
                            <div class="option-info">
                                <h4><%= __('profile.integrations.accountUpdates') %></h4>
                                <p><%= __('profile.integrations.accountUpdatesDesc') %></p>
                            </div>
                            <div class="option-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailAccountUpdates">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mailing Lists -->
    <div class="settings-card">
        <div class="card-header">
            <h2>
                <span class="material-symbols-outlined">mail</span>
                <%= __('profile.integrations.emailLists') %>
            </h2>
            <p><%= __('profile.integrations.emailListsDesc') %></p>
        </div>
        <div class="card-content">
            <div class="mailing-lists-container" id="mailingListsContainer">
                <div class="loading-state" id="mailingListsLoading">
                    <div class="loading-spinner"></div>
                    <span><%= __('profile.integrations.loadingMailingLists') %></span>
                </div>
                
                <div class="mailing-lists-content" id="mailingListsContent" style="display: none;">
                    <div class="mailing-lists-header">
                        <p><%= __('profile.integrations.manageSubscriptions') %></p>
                    </div>
                    
                    <div class="mailing-lists-list" id="mailingListsList">
                        <!-- Mailing lists will be populated here -->
                    </div>
                    
                    <div class="no-subscriptions" id="noSubscriptions" style="display: none;">
                        <div class="empty-state">
                            <span class="material-symbols-outlined">unsubscribe</span>
                            <h3><%= __('profile.integrations.noActiveSubscriptions') %></h3>
                            <p><%= __('profile.integrations.notSubscribedToLists') %></p>
                        </div>
                    </div>
                </div>
                
                <div class="error-state" id="mailingListsError" style="display: none;">
                    <span class="material-symbols-outlined">error</span>
                    <span><%= __('profile.integrations.failedToLoadLists') %></span>
                    <button class="btn btn-secondary retry-btn" id="retryLoadLists">
                        <span class="material-symbols-outlined">refresh</span>
                        <%= __('profile.integrations.retry') %>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Display Preferences -->
    <div class="settings-card">
        <div class="card-header">
            <h2>
                <span class="material-symbols-outlined">tune</span>
                <%= __('profile.integrations.displayPreferences') %>
            </h2>
            <p><%= __('profile.integrations.displayPreferencesDesc') %></p>
        </div>
        <div class="card-content">
            <div class="setting-group">
                <label class="setting-label" for="languageSelect">
                    <%= __('profile.integrations.language') %>
                </label>
                <div class="setting-input-group">
                    <select class="setting-input" id="languageSelect" data-current-lang="<%= locale %>">
                        <option value="en" <%= locale === 'en' ? 'selected' : '' %>>
                            🇺🇸 English
                        </option>
                        <option value="fr" <%= locale === 'fr' ? 'selected' : '' %>>
                            🇫🇷 Français
                        </option>
                        <option value="es" <%= locale === 'es' ? 'selected' : '' %>>
                            🇪🇸 Español
                        </option>
                    </select>
                    <div class="input-actions">
                        <button class="btn btn-sm btn-primary save-btn" id="saveLanguageBtn">
                            <span class="material-symbols-outlined">save</span>
                        </button>
                    </div>
                </div>
                <small class="setting-help"><%= __('profile.integrations.languageHelp') %></small>
                <div class="setting-status" id="status-language"></div>
            </div>

            <div class="setting-group">
                <label class="setting-label" for="dateFormatSelect">
                    <%= __('profile.integrations.dateFormat') %>
                </label>
                <div class="setting-input-group">
                    <select class="setting-input" id="dateFormatSelect">
                        <option value="DD/MM/YYYY">DD/MM/YYYY (31/12/2024)</option>
                        <option value="MM/DD/YYYY">MM/DD/YYYY (12/31/2024)</option>
                        <option value="YYYY-MM-DD">YYYY-MM-DD (2024-12-31)</option>
                        <option value="DD.MM.YYYY">DD.MM.YYYY (31.12.2024)</option>
                    </select>
                    <div class="input-actions">
                        <button class="btn btn-sm btn-primary save-btn" id="saveDateFormatBtn">
                            <span class="material-symbols-outlined">save</span>
                        </button>
                    </div>
                </div>
                <small class="setting-help"><%= __('profile.integrations.dateFormatHelp') %></small>
                <div class="setting-status" id="status-dateformat"></div>
            </div>

            <div class="setting-group">
                <label class="setting-label" for="timeFormatSelect">
                    <%= __('profile.integrations.timeFormat') %>
                </label>
                <div class="setting-input-group">
                    <select class="setting-input" id="timeFormatSelect">
                        <option value="24h">24-hour (14:30)</option>
                        <option value="12h">12-hour (2:30 PM)</option>
                    </select>
                    <div class="input-actions">
                        <button class="btn btn-sm btn-primary save-btn" id="saveTimeFormatBtn">
                            <span class="material-symbols-outlined">save</span>
                        </button>
                    </div>
                </div>
                <small class="setting-help"><%= __('profile.integrations.timeFormatHelp') %></small>
                <div class="setting-status" id="status-timeformat"></div>
            </div>

            <div class="setting-group">
                <label class="setting-label" for="timezoneSelect">
                    <%= __('profile.integrations.timeZone') %>
                </label>
                <div class="setting-input-group">
                    <select class="setting-input" id="timezoneSelect">
                        <option value="Europe/Luxembourg">Europe/Luxembourg (CET/CEST)</option>
                        <option value="Europe/Paris">Europe/Paris (CET/CEST)</option>
                        <option value="Europe/Berlin">Europe/Berlin (CET/CEST)</option>
                        <option value="Europe/London">Europe/London (GMT/BST)</option>
                        <option value="America/New_York">America/New York (EST/EDT)</option>
                        <option value="America/Chicago">America/Chicago (CST/CDT)</option>
                        <option value="America/Los_Angeles">America/Los Angeles (PST/PDT)</option>
                        <option value="UTC">UTC (Coordinated Universal Time)</option>
                    </select>
                    <div class="input-actions">
                        <button class="btn btn-sm btn-primary save-btn" id="saveTimezoneBtn">
                            <span class="material-symbols-outlined">save</span>
                        </button>
                    </div>
                </div>
                <small class="setting-help"><%= __('profile.integrations.timeZoneHelp') %></small>
                <div class="setting-status" id="status-timezone"></div>
            </div>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div class="toast" id="toast">
    <div class="toast-content">
        <span class="toast-icon material-symbols-outlined"></span>
        <span class="toast-message"></span>
    </div>
</div>